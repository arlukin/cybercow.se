<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>fareofficelib: ODBCResultSet Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>ODBCResultSet Class Reference</h1><!-- doxytag: class="ODBCResultSet" --><!-- doxytag: inherits="ODBCResultSetCommon,ResultSet" --><div class="dynheader">
Inheritance diagram for ODBCResultSet:</div>
<div class="dynsection">

<p><center><img src="classODBCResultSet.png" usemap="#ODBCResultSet_map" border="0" alt=""></center>
<map name="ODBCResultSet_map">
<area href="classODBCResultSetCommon.html" alt="ODBCResultSetCommon" shape="rect" coords="0,56,148,80">
<area href="interfaceResultSet.html" alt="ResultSet" shape="rect" coords="158,56,306,80">
<area href="classResultSetCommon.html" alt="ResultSetCommon" shape="rect" coords="0,0,148,24">
</map>
</div>

<p>
<a href="classODBCResultSet-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classODBCResultSet.html#78b75cc67a1de6da4d39375fe5d10347">__construct</a> (<a class="el" href="interfaceConnection.html">Connection</a> $conn, $result, $fetchmode=null)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classODBCResultSet.html#0603c75d1c33ba98f59e55bc53d67109">close</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classODBCResultSet.html#7789e499886b0a9e3e03e9ce68ef5224">seek</a> ($rownum)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classODBCResultSet.html#4825e9aba668803c1547b8a32a4ef8af">next</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classODBCResultSet.html#3b450a953e426751d542d8b934336104">isAfterLast</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classODBCResultSet.html#e16b3bdaedf3c1895fe4653c95357987">getRecordCount</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classODBCResultSet.html#51ee353e2cedbfcf4f95783b821377a5">getBlob</a> ($column)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classODBCResultSet.html#2bd9ff266ca958d30c02e6e47572c4fa">getClob</a> ($column)</td></tr>

<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classODBCResultSet.html#b09ddcb2c8be04e60c17854cdf5a235c">$numRows</a> = -1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classODBCResultSet.html#c738b59d019c006072465cca1d4fe180">$hasRowCount</a> = false</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>

<p>Definition at line <a class="el" href="ODBCResultSet_8php-source.html#l00045">45</a> of file <a class="el" href="ODBCResultSet_8php-source.html">ODBCResultSet.php</a>.</p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="78b75cc67a1de6da4d39375fe5d10347"></a><!-- doxytag: member="ODBCResultSet::__construct" ref="78b75cc67a1de6da4d39375fe5d10347" args="(Connection $conn, $result, $fetchmode=null)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ODBCResultSet::__construct           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="interfaceConnection.html">Connection</a> $&nbsp;</td>
          <td class="paramname"> <em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>fetchmode</em> = <code>null</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd>ResultSet::__construct() </dd></dl>

<p>
Some ODBC drivers appear not to handle odbc_num_rows() very well when more than one result handle is active at once. For example, the MySQL ODBC driver always returns the number of rows for the last executed result. For this reason, we'll store the row count here.<p>
Note also that many ODBC drivers do not support this method. In this case, <a class="el" href="classODBCResultSet.html#e16b3bdaedf3c1895fe4653c95357987">getRecordCount()</a> will perform a manual count.
<p>Reimplemented from <a class="el" href="classODBCResultSetCommon.html#9772d08d63e3a87b419d48c96ce08576">ODBCResultSetCommon</a>.</p>

<p>Definition at line <a class="el" href="ODBCResultSet_8php-source.html#l00064">64</a> of file <a class="el" href="ODBCResultSet_8php-source.html">ODBCResultSet.php</a>.</p>

<p>References <a class="el" href="ResultSetCommon_8php-source.html#l00059">ResultSetCommon::$fetchmode</a>, and <a class="el" href="ResultSetCommon_8php-source.html#l00071">ResultSetCommon::$result</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00065"></a>00065     {
<a name="l00066"></a>00066         <a class="code" href="classODBCResultSet.html#78b75cc67a1de6da4d39375fe5d10347">parent::__construct</a>(<a class="code" href="classResultSetCommon.html#2b3610aba8b38e5f340882f1f712e4e5">$conn</a>, <a class="code" href="classResultSetCommon.html#f1cb5c95d5c399f1e24b86660db5b00a">$result</a>, <a class="code" href="classResultSetCommon.html#3186516f55e79ddf9c3f0f384c3af719">$fetchmode</a>);
<a name="l00067"></a>00067 
<a name="l00077"></a>00077         $this-&gt;numRows = @odbc_num_rows(<a class="code" href="classResultSetCommon.html#f1cb5c95d5c399f1e24b86660db5b00a">$result</a>-&gt;getHandle());
<a name="l00078"></a>00078         $this-&gt;hasRowCount = $this-&gt;numRows != -1;
<a name="l00079"></a>00079     }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="0603c75d1c33ba98f59e55bc53d67109"></a><!-- doxytag: member="ODBCResultSet::close" ref="0603c75d1c33ba98f59e55bc53d67109" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ODBCResultSet::close           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="classODBCResultSetCommon.html#3958fd00e378611a4e2af699b9b501b9">ODBCResultSetCommon::close()</a> </dd></dl>

<p>Reimplemented from <a class="el" href="classODBCResultSetCommon.html#3958fd00e378611a4e2af699b9b501b9">ODBCResultSetCommon</a>.</p>

<p>Definition at line <a class="el" href="ODBCResultSet_8php-source.html#l00084">84</a> of file <a class="el" href="ODBCResultSet_8php-source.html">ODBCResultSet.php</a>.</p>

<p>References <a class="el" href="ODBCResultSet_8php-source.html#l00052">$numRows</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00085"></a>00085     {
<a name="l00086"></a>00086         <a class="code" href="classODBCResultSet.html#0603c75d1c33ba98f59e55bc53d67109">parent::close</a>();
<a name="l00087"></a>00087         <a class="code" href="classODBCResultSet.html#b09ddcb2c8be04e60c17854cdf5a235c">$numRows</a> = -1;
<a name="l00088"></a>00088     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="51ee353e2cedbfcf4f95783b821377a5"></a><!-- doxytag: member="ODBCResultSet::getBlob" ref="51ee353e2cedbfcf4f95783b821377a5" args="($column)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ODBCResultSet::getBlob           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>column</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="interfaceResultSet.html#8319eb558390ea0096f2c201654533a6" title="Returns Blob with contents of column value.">ResultSet::getBlob()</a> </dd></dl>

<p>Implements <a class="el" href="interfaceResultSet.html#8319eb558390ea0096f2c201654533a6">ResultSet</a>.</p>

<p>Definition at line <a class="el" href="ODBCResultSet_8php-source.html#l00182">182</a> of file <a class="el" href="ODBCResultSet_8php-source.html">ODBCResultSet.php</a>.</p>

<p>References <a class="el" href="ODBCResultSetCommon_8php-source.html#l00125">ODBCResultSetCommon::readLobData()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00183"></a>00183     {
<a name="l00184"></a>00184         require_once <span class="stringliteral">'creole/util/Blob.php'</span>;
<a name="l00185"></a>00185         $idx = (is_int($column) ? $column - 1 : $column);
<a name="l00186"></a>00186         <span class="keywordflow">if</span> (!array_key_exists($idx, $this-&gt;fields)) { <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classSQLException.html">SQLException</a>(<span class="stringliteral">"Invalid resultset column: "</span> . $column); }
<a name="l00187"></a>00187         $data = $this-&gt;<a class="code" href="classODBCResultSetCommon.html#eb5fbc1910a40fb4239b183ef63363be" title="Reads in any unread LOB data.">readLobData</a>($column, ODBC_BINMODE_RETURN, $this-&gt;fields[$idx]);
<a name="l00188"></a>00188         <span class="keywordflow">if</span> (!$data) { <span class="keywordflow">return</span> null; }
<a name="l00189"></a>00189         $b = <span class="keyword">new</span> <a class="code" href="classBlob.html">Blob</a>();
<a name="l00190"></a>00190         $b-&gt;setContents($data);
<a name="l00191"></a>00191         <span class="keywordflow">return</span> $b;
<a name="l00192"></a>00192     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="2bd9ff266ca958d30c02e6e47572c4fa"></a><!-- doxytag: member="ODBCResultSet::getClob" ref="2bd9ff266ca958d30c02e6e47572c4fa" args="($column)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ODBCResultSet::getClob           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>column</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="interfaceResultSet.html#144b18429d0c1f8c02b5b95e5f71a504" title="Returns Clob with contents of column value.">ResultSet::getClob()</a> </dd></dl>

<p>Implements <a class="el" href="interfaceResultSet.html#144b18429d0c1f8c02b5b95e5f71a504">ResultSet</a>.</p>

<p>Definition at line <a class="el" href="ODBCResultSet_8php-source.html#l00197">197</a> of file <a class="el" href="ODBCResultSet_8php-source.html">ODBCResultSet.php</a>.</p>

<p>References <a class="el" href="ODBCResultSetCommon_8php-source.html#l00125">ODBCResultSetCommon::readLobData()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00198"></a>00198     {
<a name="l00199"></a>00199         require_once <span class="stringliteral">'creole/util/Clob.php'</span>;
<a name="l00200"></a>00200         $idx = (is_int($column) ? $column - 1 : $column);
<a name="l00201"></a>00201         <span class="keywordflow">if</span> (!array_key_exists($idx, $this-&gt;fields)) { <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classSQLException.html">SQLException</a>(<span class="stringliteral">"Invalid resultset column: "</span> . $column); }
<a name="l00202"></a>00202         $data = $this-&gt;<a class="code" href="classODBCResultSetCommon.html#eb5fbc1910a40fb4239b183ef63363be" title="Reads in any unread LOB data.">readLobData</a>($column, ODBC_BINMODE_CONVERT, $this-&gt;fields[$idx]);
<a name="l00203"></a>00203         <span class="keywordflow">if</span> (!$data) { <span class="keywordflow">return</span> null; }
<a name="l00204"></a>00204         $c = <span class="keyword">new</span> <a class="code" href="classClob.html">Clob</a>();
<a name="l00205"></a>00205         $c-&gt;setContents($data);
<a name="l00206"></a>00206         <span class="keywordflow">return</span> $c;
<a name="l00207"></a>00207     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="e16b3bdaedf3c1895fe4653c95357987"></a><!-- doxytag: member="ODBCResultSet::getRecordCount" ref="e16b3bdaedf3c1895fe4653c95357987" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ODBCResultSet::getRecordCount           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="interfaceResultSet.html#8ed3ee8f3319764403af33f00bfaa814" title="Get the number of rows in a result set.">ResultSet::getRecordCount()</a> </dd></dl>

<p>Implements <a class="el" href="interfaceResultSet.html#8ed3ee8f3319764403af33f00bfaa814">ResultSet</a>.</p>

<p>Definition at line <a class="el" href="ODBCResultSet_8php-source.html#l00145">145</a> of file <a class="el" href="ODBCResultSet_8php-source.html">ODBCResultSet.php</a>.</p>

<p>References <a class="el" href="ODBCResultSet_8php-source.html#l00052">$numRows</a>, <a class="el" href="interfaceResultSet.html#5732a24cf22dccd00d90746dcb2f6b31">ResultSet::beforeFirst()</a>, and <a class="el" href="ODBCResultSet_8php-source.html#l00106">next()</a>.</p>

<p>Referenced by <a class="el" href="ODBCResultSet_8php-source.html#l00133">isAfterLast()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00146"></a>00146     {
<a name="l00147"></a>00147         <span class="keywordflow">if</span> ($this-&gt;hasRowCount)
<a name="l00148"></a>00148         {
<a name="l00149"></a>00149             <span class="comment">// Use driver row count if provided.</span>
<a name="l00150"></a>00150             <a class="code" href="classODBCResultSet.html#b09ddcb2c8be04e60c17854cdf5a235c">$numRows</a> = $this-&gt;numRows - $this-&gt;offset;
<a name="l00151"></a>00151 
<a name="l00152"></a>00152             <span class="keywordflow">if</span> ($this-&gt;limit &gt; 0 &amp;&amp; <a class="code" href="classODBCResultSet.html#b09ddcb2c8be04e60c17854cdf5a235c">$numRows</a> &gt; $this-&gt;limit)
<a name="l00153"></a>00153                 <a class="code" href="classODBCResultSet.html#b09ddcb2c8be04e60c17854cdf5a235c">$numRows</a> = $this-&gt;limit;
<a name="l00154"></a>00154         }
<a name="l00155"></a>00155         <span class="keywordflow">else</span> 
<a name="l00156"></a>00156         {
<a name="l00157"></a>00157             <span class="comment">// Do manual row count if driver doesn't provide one.</span>
<a name="l00158"></a>00158             <span class="keywordflow">if</span> ($this-&gt;numRows == -1) 
<a name="l00159"></a>00159             {
<a name="l00160"></a>00160                 $this-&gt;numRows = 0;
<a name="l00161"></a>00161                 $this-&gt;<a class="code" href="interfaceResultSet.html#5732a24cf22dccd00d90746dcb2f6b31" title="Sets cursort to before first record.">beforeFirst</a>();
<a name="l00162"></a>00162             
<a name="l00163"></a>00163                 <span class="keywordflow">while</span>($this-&gt;<a class="code" href="classODBCResultSet.html#4825e9aba668803c1547b8a32a4ef8af">next</a>()) 
<a name="l00164"></a>00164                     $this-&gt;numRows++;
<a name="l00165"></a>00165             }
<a name="l00166"></a>00166                 
<a name="l00167"></a>00167             <a class="code" href="classODBCResultSet.html#b09ddcb2c8be04e60c17854cdf5a235c">$numRows</a> = $this-&gt;numRows;
<a name="l00168"></a>00168         }
<a name="l00169"></a>00169 
<a name="l00170"></a>00170         <span class="comment">// Cursor pos is -1 when an attempt to fetch past the last row was made</span>
<a name="l00171"></a>00171         <span class="comment">// (or a fetch error occured).</span>
<a name="l00172"></a>00172         
<a name="l00173"></a>00173         <span class="keywordflow">if</span> ($this-&gt;cursorPos == -1)
<a name="l00174"></a>00174             $this-&gt;cursorPos = <a class="code" href="classODBCResultSet.html#b09ddcb2c8be04e60c17854cdf5a235c">$numRows</a>+1;
<a name="l00175"></a>00175             
<a name="l00176"></a>00176         <span class="keywordflow">return</span> <a class="code" href="classODBCResultSet.html#b09ddcb2c8be04e60c17854cdf5a235c">$numRows</a>;
<a name="l00177"></a>00177     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="3b450a953e426751d542d8b934336104"></a><!-- doxytag: member="ODBCResultSet::isAfterLast" ref="3b450a953e426751d542d8b934336104" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ODBCResultSet::isAfterLast           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="interfaceResultSet.html#45ca9a07b6b5d49b399881c288ba06d0" title="Checks whether cursor is after the last record.">ResultSet::isAfterLast()</a> </dd></dl>

<p>Implements <a class="el" href="interfaceResultSet.html#45ca9a07b6b5d49b399881c288ba06d0">ResultSet</a>.</p>

<p>Definition at line <a class="el" href="ODBCResultSet_8php-source.html#l00133">133</a> of file <a class="el" href="ODBCResultSet_8php-source.html">ODBCResultSet.php</a>.</p>

<p>References <a class="el" href="ODBCResultSet_8php-source.html#l00145">getRecordCount()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00134"></a>00134     {
<a name="l00135"></a>00135         <span class="comment">// Force calculation of last record pos.</span>
<a name="l00136"></a>00136         <span class="keywordflow">if</span> ($this-&gt;cursorPos == -1)
<a name="l00137"></a>00137             $this-&gt;<a class="code" href="classODBCResultSet.html#e16b3bdaedf3c1895fe4653c95357987">getRecordCount</a>();
<a name="l00138"></a>00138             
<a name="l00139"></a>00139         <span class="keywordflow">return</span> <a class="code" href="classODBCResultSet.html#3b450a953e426751d542d8b934336104">parent::isAfterLast</a>();
<a name="l00140"></a>00140     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="4825e9aba668803c1547b8a32a4ef8af"></a><!-- doxytag: member="ODBCResultSet::next" ref="4825e9aba668803c1547b8a32a4ef8af" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ODBCResultSet::next           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="interfaceResultSet.html#89147d28fe683b875fedc44c8da2dba9" title="Moves the internal cursor to the next position and fetches the row at that position...">ResultSet::next()</a> </dd></dl>

<p>Implements <a class="el" href="interfaceResultSet.html#89147d28fe683b875fedc44c8da2dba9">ResultSet</a>.</p>

<p>Definition at line <a class="el" href="ODBCResultSet_8php-source.html#l00106">106</a> of file <a class="el" href="ODBCResultSet_8php-source.html">ODBCResultSet.php</a>.</p>

<p>References <a class="el" href="ResultSetCommon_8php-source.html#l00083">ResultSetCommon::$fields</a>, and <a class="el" href="ODBCResultSetCommon_8php-source.html#l00165">ODBCResultSetCommon::checkFetchMode()</a>.</p>

<p>Referenced by <a class="el" href="ODBCResultSet_8php-source.html#l00145">getRecordCount()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00107"></a>00107     {
<a name="l00108"></a>00108         $this-&gt;cursorPos++;
<a name="l00109"></a>00109         
<a name="l00110"></a>00110         <span class="keywordflow">if</span> ($this-&gt;limit &gt; 0 &amp;&amp; $this-&gt;cursorPos &gt; $this-&gt;limit) {
<a name="l00111"></a>00111             $this-&gt;cursorPos = $this-&gt;limit+1;
<a name="l00112"></a>00112             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00113"></a>00113         }
<a name="l00114"></a>00114 
<a name="l00115"></a>00115         $rowNum = $this-&gt;offset + $this-&gt;cursorPos;
<a name="l00116"></a>00116         <a class="code" href="classResultSetCommon.html#a30c6bdab519227896c86b143514b9ae">$fields</a> = null;
<a name="l00117"></a>00117         
<a name="l00118"></a>00118         $cols = @odbc_fetch_into($this-&gt;result-&gt;getHandle(), <a class="code" href="classResultSetCommon.html#a30c6bdab519227896c86b143514b9ae">$fields</a>, $rowNum);
<a name="l00119"></a>00119 
<a name="l00120"></a>00120         <span class="keywordflow">if</span> ($cols === <span class="keyword">false</span>) {
<a name="l00121"></a>00121             $this-&gt;cursorPos = -1;
<a name="l00122"></a>00122             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00123"></a>00123         }
<a name="l00124"></a>00124 
<a name="l00125"></a>00125         $this-&gt;fields =&amp; $this-&gt;<a class="code" href="classODBCResultSetCommon.html#447fcfae1af9c5a495c9c4b264396313" title="Converts row fields to names if FETCHMODE_ASSOC is set.">checkFetchMode</a>(<a class="code" href="classResultSetCommon.html#a30c6bdab519227896c86b143514b9ae">$fields</a>);
<a name="l00126"></a>00126         
<a name="l00127"></a>00127         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00128"></a>00128     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="7789e499886b0a9e3e03e9ce68ef5224"></a><!-- doxytag: member="ODBCResultSet::seek" ref="7789e499886b0a9e3e03e9ce68ef5224" args="($rownum)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ODBCResultSet::seek           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>rownum</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="interfaceResultSet.html#da202a6ce1b59224eea3483afe90fe73" title="Moves cursor position WITHOUT FETCHING ROW AT THAT POSITION.">ResultSet::seek()</a> </dd></dl>

<p>Implements <a class="el" href="interfaceResultSet.html#da202a6ce1b59224eea3483afe90fe73">ResultSet</a>.</p>

<p>Definition at line <a class="el" href="ODBCResultSet_8php-source.html#l00093">93</a> of file <a class="el" href="ODBCResultSet_8php-source.html">ODBCResultSet.php</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00094"></a>00094     {
<a name="l00095"></a>00095         <span class="keywordflow">if</span> ($rownum &lt; 0 || $this-&gt;limit &gt; 0 &amp;&amp; $rownum &gt; $this-&gt;limit)
<a name="l00096"></a>00096             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00097"></a>00097         
<a name="l00098"></a>00098         $this-&gt;cursorPos = $rownum;
<a name="l00099"></a>00099 
<a name="l00100"></a>00100         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00101"></a>00101     }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="c738b59d019c006072465cca1d4fe180"></a><!-- doxytag: member="ODBCResultSet::$hasRowCount" ref="c738b59d019c006072465cca1d4fe180" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ODBCResultSet::$hasRowCount = false<code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="ODBCResultSet_8php-source.html#l00059">59</a> of file <a class="el" href="ODBCResultSet_8php-source.html">ODBCResultSet.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="b09ddcb2c8be04e60c17854cdf5a235c"></a><!-- doxytag: member="ODBCResultSet::$numRows" ref="b09ddcb2c8be04e60c17854cdf5a235c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ODBCResultSet::$numRows = -1<code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="ODBCResultSet_8php-source.html#l00052">52</a> of file <a class="el" href="ODBCResultSet_8php-source.html">ODBCResultSet.php</a>.</p>

<p>Referenced by <a class="el" href="ODBCResultSet_8php-source.html#l00084">close()</a>, and <a class="el" href="ODBCResultSet_8php-source.html#l00145">getRecordCount()</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li>Static/PhpInclude/FareOfficeLib/3dPart/creole/drivers/odbc/<a class="el" href="ODBCResultSet_8php-source.html">ODBCResultSet.php</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed May 6 23:10:50 2009 for fareofficelib by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
