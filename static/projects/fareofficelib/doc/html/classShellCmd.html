<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>fareofficelib: ShellCmd Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>ShellCmd Class Reference<br>
<small>
[<a class="el" href="group__general.html">General</a>]</small>
</h1><!-- doxytag: class="ShellCmd" -->Functions to execute shell commands.  
<a href="#_details">More...</a>
<p>

<p>
<a href="classShellCmd-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classShellCmd.html#e587b4b213bade2f0cdb8e66b153cfcc">exec</a> ($command_, $parameter_=NULL)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Execute any shell command.  <a href="#e587b4b213bade2f0cdb8e66b153cfcc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classShellCmd.html#413a712c24cc24de52720c6da0ea1b0a">sshExec</a> ($remoteServer_, $command_)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Execute a shell command on a remoteserver, through SSH.  <a href="#413a712c24cc24de52720c6da0ea1b0a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classShellCmd.html#cea661065af1335978f88e726e7661f5">sshGet</a> ($remoteServer_, $from_, $to_)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a file from a remote server through SSH.  <a href="#cea661065af1335978f88e726e7661f5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classShellCmd.html#d8b25dfd10af40ec7830d00c655176ce">sshPut</a> ($remoteServer_, $from_, $to_)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Put a file on a remote server through SSH.  <a href="#d8b25dfd10af40ec7830d00c655176ce"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Functions to execute shell commands. 
<p>
<dl class="author" compact><dt><b>Author:</b></dt><dd>Daniel Lindh &lt;<a href="mailto:daniel@fareoffice.com">daniel@fareoffice.com</a>&gt;</dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>: Use escapeshellarg() or escapeshellcmd() to ensure that users cannot trick the system into executing arbitrary commands. </dd></dl>

<p>Definition at line <a class="el" href="ShellCmd_8class_8php-source.html#l00010">10</a> of file <a class="el" href="ShellCmd_8class_8php-source.html">ShellCmd.class.php</a>.</p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="e587b4b213bade2f0cdb8e66b153cfcc"></a><!-- doxytag: member="ShellCmd::exec" ref="e587b4b213bade2f0cdb8e66b153cfcc" args="($command_, $parameter_=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static ShellCmd::exec           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>command_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>parameter_</em> = <code>NULL</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Execute any shell command. 
<p>
If any error occurs an exception will be sent.<p>
<div class="fragment"><pre class="fragment"> <span class="keywordflow">try</span>
 {
   <a class="code" href="classShellCmd.html#e587b4b213bade2f0cdb8e66b153cfcc" title="Execute any shell command.">ShellCmd::exec</a>(<span class="stringliteral">'whoami'</span>);
   <a class="code" href="classShellCmd.html#e587b4b213bade2f0cdb8e66b153cfcc" title="Execute any shell command.">ShellCmd::exec</a>(<span class="stringliteral">"wc"</span>, <span class="stringliteral">"I may be synthetic, but I\'m not stupid.\n\n"</span>);
 }
 <span class="keywordflow">catch</span> (Exception $e)
 {
   <span class="keywordflow">return</span> $e-&gt;getMessage();
 }
</pre></div><p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$command_</em>&nbsp;</td><td>- string - The command that should be executed.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$parameter_</em>&nbsp;</td><td>- string - Any parameter that should be sent to the shell input, after the command has been executed. Ie. A password after a login command has been executed</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>- string - The output generated by the command. </dd></dl>

<p>Definition at line <a class="el" href="ShellCmd_8class_8php-source.html#l00040">40</a> of file <a class="el" href="ShellCmd_8class_8php-source.html">ShellCmd.class.php</a>.</p>

<p>Referenced by <a class="el" href="ShellCmd_8class_8php-source.html#l00108">sshExec()</a>, <a class="el" href="ShellCmd_8class_8php-source.html#l00129">sshGet()</a>, <a class="el" href="ShellCmd_8class_8php-source.html#l00150">sshPut()</a>, and <a class="el" href="UTShellCmd_8class_8php-source.html#l00017">UTShellCmd::testExec()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00041"></a>00041   {
<a name="l00042"></a>00042     $retval = <span class="stringliteral">''</span>;
<a name="l00043"></a>00043     $error = <span class="stringliteral">''</span>;
<a name="l00044"></a>00044 
<a name="l00045"></a>00045     $descriptorspec = array
<a name="l00046"></a>00046     (
<a name="l00047"></a>00047       0 =&gt; array(<span class="stringliteral">'pipe'</span>, <span class="charliteral">'r'</span>),
<a name="l00048"></a>00048       1 =&gt; array(<span class="stringliteral">'pipe'</span>, <span class="charliteral">'w'</span>),
<a name="l00049"></a>00049       2 =&gt; array(<span class="stringliteral">'pipe'</span>, <span class="charliteral">'w'</span>)
<a name="l00050"></a>00050     );
<a name="l00051"></a>00051     $pipes = array();
<a name="l00052"></a>00052 
<a name="l00053"></a>00053     $resource = proc_open($command_, $descriptorspec, $pipes, null, $_ENV);
<a name="l00054"></a>00054     <span class="keywordflow">if</span> (is_resource($resource))
<a name="l00055"></a>00055     {
<a name="l00056"></a>00056       $stdin = $pipes[0];
<a name="l00057"></a>00057       $stdout = $pipes[1];
<a name="l00058"></a>00058       $stderr = $pipes[2];
<a name="l00059"></a>00059 
<a name="l00060"></a>00060       <span class="comment">// Write to standard in</span>
<a name="l00061"></a>00061       <span class="keywordflow">if</span> (!empty($parameter_))
<a name="l00062"></a>00062       {
<a name="l00063"></a>00063         fwrite($stdin, $parameter_);
<a name="l00064"></a>00064       }
<a name="l00065"></a>00065       fclose($stdin);
<a name="l00066"></a>00066 
<a name="l00067"></a>00067       <span class="comment">// Get result from command</span>
<a name="l00068"></a>00068       <span class="keywordflow">while</span> (!feof($stdout))
<a name="l00069"></a>00069       {
<a name="l00070"></a>00070         $retval .= fgets($stdout);
<a name="l00071"></a>00071       }
<a name="l00072"></a>00072       fclose($stdout);
<a name="l00073"></a>00073 
<a name="l00074"></a>00074       <span class="comment">// Get the errors back, if any</span>
<a name="l00075"></a>00075       <span class="keywordflow">while</span> (!feof($stderr))
<a name="l00076"></a>00076       {
<a name="l00077"></a>00077         $error .= fgets($stderr);
<a name="l00078"></a>00078       }
<a name="l00079"></a>00079       fclose($stderr);
<a name="l00080"></a>00080 
<a name="l00081"></a>00081       $exitCode =  proc_close($resource);
<a name="l00082"></a>00082       <span class="keywordflow">if</span> (0 != $exitCode)
<a name="l00083"></a>00083       {
<a name="l00084"></a>00084         $error .= <span class="stringliteral">' Exit code: '</span> . $exitCode;
<a name="l00085"></a>00085       }
<a name="l00086"></a>00086     }
<a name="l00087"></a>00087 
<a name="l00088"></a>00088     <span class="keywordflow">if</span> (! empty($error))
<a name="l00089"></a>00089     {
<a name="l00090"></a>00090       <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception($error);
<a name="l00091"></a>00091     }
<a name="l00092"></a>00092     <span class="keywordflow">else</span>
<a name="l00093"></a>00093     {
<a name="l00094"></a>00094       <span class="keywordflow">return</span> $retval;
<a name="l00095"></a>00095     }
<a name="l00096"></a>00096   }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="413a712c24cc24de52720c6da0ea1b0a"></a><!-- doxytag: member="ShellCmd::sshExec" ref="413a712c24cc24de52720c6da0ea1b0a" args="($remoteServer_, $command_)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static ShellCmd::sshExec           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>remoteServer_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>command_</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Execute a shell command on a remoteserver, through SSH. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$remoteServer_</em>&nbsp;</td><td>- string - Login and servername of remote server Ie. <a href="mailto:fareoffice@dpwww1.fareoffice.com">fareoffice@dpwww1.fareoffice.com</a></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$command_</em>&nbsp;</td><td>- string - The command that should be executed on the remote server. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="ShellCmd_8class_8php-source.html#l00108">108</a> of file <a class="el" href="ShellCmd_8class_8php-source.html">ShellCmd.class.php</a>.</p>

<p>References <a class="el" href="ShellCmd_8class_8php-source.html#l00040">exec()</a>.</p>

<p>Referenced by <a class="el" href="UTShellCmd_8class_8php-source.html#l00042">UTShellCmd::testSshExec()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00109"></a>00109   {
<a name="l00110"></a>00110     <span class="keywordflow">return</span> <a class="code" href="classShellCmd.html#e587b4b213bade2f0cdb8e66b153cfcc" title="Execute any shell command.">ShellCmd::exec</a>(<span class="stringliteral">'/usr/bin/ssh '</span> . $remoteServer_ . <span class="stringliteral">' "'</span> . $command_ . <span class="charliteral">'"'</span>);
<a name="l00111"></a>00111   }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="cea661065af1335978f88e726e7661f5"></a><!-- doxytag: member="ShellCmd::sshGet" ref="cea661065af1335978f88e726e7661f5" args="($remoteServer_, $from_, $to_)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static ShellCmd::sshGet           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>remoteServer_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>from_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>to_</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get a file from a remote server through SSH. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$remoteServer_</em>&nbsp;</td><td>Login and servername of remote server Ie. <a href="mailto:fareoffice@dpwww1.fareoffice.com">fareoffice@dpwww1.fareoffice.com</a></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$from_</em>&nbsp;</td><td>Directory and file on remote server that should be copied. Ie. /home/fareoffice/file.txt</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$to_</em>&nbsp;</td><td>Directory and file on local server where the file should be copied to. Ie. /home/fareoffice/LocalFile.txt </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="ShellCmd_8class_8php-source.html#l00129">129</a> of file <a class="el" href="ShellCmd_8class_8php-source.html">ShellCmd.class.php</a>.</p>

<p>References <a class="el" href="ShellCmd_8class_8php-source.html#l00040">exec()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00130"></a>00130   {
<a name="l00131"></a>00131     <a class="code" href="classShellCmd.html#e587b4b213bade2f0cdb8e66b153cfcc" title="Execute any shell command.">ShellCmd::exec</a>(<span class="stringliteral">'/usr/bin/scp '</span> . $remoteServer_ . <span class="charliteral">':'</span> . $from_ . <span class="charliteral">' '</span> . $to_);
<a name="l00132"></a>00132   }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="d8b25dfd10af40ec7830d00c655176ce"></a><!-- doxytag: member="ShellCmd::sshPut" ref="d8b25dfd10af40ec7830d00c655176ce" args="($remoteServer_, $from_, $to_)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static ShellCmd::sshPut           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>remoteServer_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>from_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>to_</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Put a file on a remote server through SSH. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$remoteServer_</em>&nbsp;</td><td>Login and servername of remote server Ie. <a href="mailto:fareoffice@dpwww1.fareoffice.com">fareoffice@dpwww1.fareoffice.com</a></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$from_</em>&nbsp;</td><td>Directory and file on local server that should be copied. Ie. /home/fareoffice/LocalFile.txt</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$to_</em>&nbsp;</td><td>Directory and file on remote server where the file should be placed. Ie. /home/fareoffice/file.txt </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="ShellCmd_8class_8php-source.html#l00150">150</a> of file <a class="el" href="ShellCmd_8class_8php-source.html">ShellCmd.class.php</a>.</p>

<p>References <a class="el" href="ShellCmd_8class_8php-source.html#l00040">exec()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00151"></a>00151   {
<a name="l00152"></a>00152     <a class="code" href="classShellCmd.html#e587b4b213bade2f0cdb8e66b153cfcc" title="Execute any shell command.">ShellCmd::exec</a>(<span class="stringliteral">'/usr/bin/scp '</span> . $from_ . <span class="charliteral">' '</span> . $remoteServer_ .<span class="charliteral">':'</span> . $to_);
<a name="l00153"></a>00153   }
</pre></div>
<p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li>Static/PhpInclude/FareOfficeLib/General/<a class="el" href="ShellCmd_8class_8php-source.html">ShellCmd.class.php</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed May 6 23:28:24 2009 for fareofficelib by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
