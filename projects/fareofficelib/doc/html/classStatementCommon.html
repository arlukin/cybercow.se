<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>fareofficelib: StatementCommon Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>StatementCommon Class Reference</h1><!-- doxytag: class="StatementCommon" --><div class="dynheader">
Inheritance diagram for StatementCommon:</div>
<div class="dynsection">

<p><center><img src="classStatementCommon.png" usemap="#StatementCommon_map" border="0" alt=""></center>
<map name="StatementCommon_map">
<area href="classMSSQLStatement.html" alt="MSSQLStatement" shape="rect" coords="0,56,114,80">
<area href="classMySQLiStatement.html" alt="MySQLiStatement" shape="rect" coords="124,56,238,80">
<area href="classMySQLStatement.html" alt="MySQLStatement" shape="rect" coords="248,56,362,80">
<area href="classOCI8Statement.html" alt="OCI8Statement" shape="rect" coords="372,56,486,80">
<area href="classODBCStatement.html" alt="ODBCStatement" shape="rect" coords="496,56,610,80">
<area href="classPgSQLStatement.html" alt="PgSQLStatement" shape="rect" coords="620,56,734,80">
<area href="classSQLiteStatement.html" alt="SQLiteStatement" shape="rect" coords="744,56,858,80">
</map>
</div>

<p>
<a href="classStatementCommon-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStatementCommon.html#adae0fdd9d503f2a3b43d3c3153aec93">__construct</a> (<a class="el" href="interfaceConnection.html">Connection</a> $conn)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create new statement instance.  <a href="#adae0fdd9d503f2a3b43d3c3153aec93"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStatementCommon.html#9d5e121f8fa145559a54d887e74fe206">setLimit</a> ($v)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets the maximum number of rows to return from db.  <a href="#9d5e121f8fa145559a54d887e74fe206"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStatementCommon.html#259d20b0662d8716e6832342796ebe0c">getLimit</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the maximum number of rows to return or 0 for all.  <a href="#259d20b0662d8716e6832342796ebe0c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStatementCommon.html#542238485483a30eb0d813a1cb660f6a">setOffset</a> ($v)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets the start row.  <a href="#542238485483a30eb0d813a1cb660f6a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStatementCommon.html#62bca439d130552f3626026997058f39">getOffset</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the start row.  <a href="#62bca439d130552f3626026997058f39"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStatementCommon.html#febd9ab8f3c38bda454a6fcaae120071">close</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Free resources associated with this statement.  <a href="#febd9ab8f3c38bda454a6fcaae120071"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStatementCommon.html#576559133fb873a6af1d09f98a880572">execute</a> ($sql, $fetchmode=null)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generic <a class="el" href="classStatementCommon.html#576559133fb873a6af1d09f98a880572" title="Generic execute() function has to check to see whether SQL is an update or select...">execute()</a> function has to check to see whether SQL is an update or select query.  <a href="#576559133fb873a6af1d09f98a880572"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStatementCommon.html#993753d50abc8179aa8979be00b1f81e">getResultSet</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get result set.  <a href="#993753d50abc8179aa8979be00b1f81e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStatementCommon.html#7983c9e7814b9ad944b5f3f6be5c3676">getUpdateCount</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get update count.  <a href="#7983c9e7814b9ad944b5f3f6be5c3676"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStatementCommon.html#51f3ba56be7287f0d661d454a06002ed">executeQuery</a> ($sql, $fetchmode=null)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Executes the SQL query in this <a class="el" href="interfacePreparedStatement.html">PreparedStatement</a> object and returns the resultset generated by the query.  <a href="#51f3ba56be7287f0d661d454a06002ed"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStatementCommon.html#5f7b5b4548ce5e9d9857f67c39449c7e">executeUpdate</a> ($sql)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Executes the SQL INSERT, UPDATE, or DELETE statement in this <a class="el" href="interfacePreparedStatement.html">PreparedStatement</a> object.  <a href="#5f7b5b4548ce5e9d9857f67c39449c7e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStatementCommon.html#3ba2cef34ce4932365531269e391f7f7">getMoreResults</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets next result set (if this behavior is supported by driver).  <a href="#3ba2cef34ce4932365531269e391f7f7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStatementCommon.html#05eb018941b9b225b94e96daf87fd6b1">getConnection</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets the db <a class="el" href="interfaceConnection.html">Connection</a> that created this statement.  <a href="#05eb018941b9b225b94e96daf87fd6b1"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStatementCommon.html#cffbc17df353ff0597acf8b94d9b73e1">isSelect</a> ($sql)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns whether the passed SQL is a SELECT statement.  <a href="#cffbc17df353ff0597acf8b94d9b73e1"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStatementCommon.html#2d5fcdafcd71692c067e85927b7d487e">$conn</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStatementCommon.html#0979c915b4dda3f79dab97151eb288b9">$resultSet</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStatementCommon.html#8068d03dd5e27dd01be9f0de4953decf">$updateCount</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStatementCommon.html#c52333efec7eb627970271498b55dd17">$warnings</a> = array()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStatementCommon.html#170505d7f5e5ff4e63b2adff761dac69">$resultClass</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStatementCommon.html#e7aa0273a038f439166a7eed9c1b2ab7">$stmt</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStatementCommon.html#948b0c678d3febac37a82b3fb7e2e580">$limit</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classStatementCommon.html#6eeb510827d12741a7c08d3a8ec4ef1d">$offset</a> = 0</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>

<p>Definition at line <a class="el" href="StatementCommon_8php-source.html#l00029">29</a> of file <a class="el" href="StatementCommon_8php-source.html">StatementCommon.php</a>.</p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="adae0fdd9d503f2a3b43d3c3153aec93"></a><!-- doxytag: member="StatementCommon::__construct" ref="adae0fdd9d503f2a3b43d3c3153aec93" args="(Connection $conn)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatementCommon::__construct           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="interfaceConnection.html">Connection</a> $&nbsp;</td>
          <td class="paramname"> <em>conn</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create new statement instance. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="interfaceConnection.html">Connection</a></em>&nbsp;</td><td>$conn <a class="el" href="interfaceConnection.html">Connection</a> object </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="StatementCommon_8php-source.html#l00085">85</a> of file <a class="el" href="StatementCommon_8php-source.html">StatementCommon.php</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00086"></a>00086     {
<a name="l00087"></a>00087         $this-&gt;conn = <a class="code" href="classStatementCommon.html#2d5fcdafcd71692c067e85927b7d487e">$conn</a>;        
<a name="l00088"></a>00088     }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="febd9ab8f3c38bda454a6fcaae120071"></a><!-- doxytag: member="StatementCommon::close" ref="febd9ab8f3c38bda454a6fcaae120071" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatementCommon::close           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Free resources associated with this statement. 
<p>
Some drivers will need to implement this method to free database result resources.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>void </dd></dl>

<p>Definition at line <a class="el" href="StatementCommon_8php-source.html#l00141">141</a> of file <a class="el" href="StatementCommon_8php-source.html">StatementCommon.php</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00142"></a>00142     {
<a name="l00143"></a>00143         <span class="comment">// do nothing here (subclasses will implement)</span>
<a name="l00144"></a>00144     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="576559133fb873a6af1d09f98a880572"></a><!-- doxytag: member="StatementCommon::execute" ref="576559133fb873a6af1d09f98a880572" args="($sql, $fetchmode=null)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatementCommon::execute           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>sql</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>fetchmode</em> = <code>null</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Generic <a class="el" href="classStatementCommon.html#576559133fb873a6af1d09f98a880572" title="Generic execute() function has to check to see whether SQL is an update or select...">execute()</a> function has to check to see whether SQL is an update or select query. 
<p>
If you already know whether it's a SELECT or an update (manipulating) SQL, then use the appropriate method, as this one will incurr overhead to check the SQL.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>int</em>&nbsp;</td><td>$fetchmode Fetchmode (only applies to queries). </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>boolean True if it is a result set, false if not or if no more results (this is identical to JDBC return val). </dd></dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="classSQLException.html">SQLException</a></em>&nbsp;</td><td></td></tr>
  </table>
</dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>-cStatementCommon Update <a class="el" href="classStatementCommon.html#576559133fb873a6af1d09f98a880572" title="Generic execute() function has to check to see whether SQL is an update or select...">execute()</a> to not use <a class="el" href="classStatementCommon.html#cffbc17df353ff0597acf8b94d9b73e1" title="Returns whether the passed SQL is a SELECT statement.">isSelect()</a> method, but rather to determine type based on returned results. </dd></dl>

<p>Definition at line <a class="el" href="StatementCommon_8php-source.html#l00157">157</a> of file <a class="el" href="StatementCommon_8php-source.html">StatementCommon.php</a>.</p>

<p>References <a class="el" href="StatementCommon_8php-source.html#l00236">executeQuery()</a>, <a class="el" href="StatementCommon_8php-source.html#l00253">executeUpdate()</a>, and <a class="el" href="StatementCommon_8php-source.html#l00219">isSelect()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00158"></a>00158     {
<a name="l00159"></a>00159         
<a name="l00160"></a>00160         <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classStatementCommon.html#cffbc17df353ff0597acf8b94d9b73e1" title="Returns whether the passed SQL is a SELECT statement.">isSelect</a>($sql)) {                    
<a name="l00161"></a>00161             $this-&gt;updateCount = $this-&gt;<a class="code" href="classStatementCommon.html#5f7b5b4548ce5e9d9857f67c39449c7e" title="Executes the SQL INSERT, UPDATE, or DELETE statement in this PreparedStatement object...">executeUpdate</a>($sql);
<a name="l00162"></a>00162             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00163"></a>00163         } <span class="keywordflow">else</span> {
<a name="l00164"></a>00164             $this-&gt;resultSet = $this-&gt;<a class="code" href="classStatementCommon.html#51f3ba56be7287f0d661d454a06002ed" title="Executes the SQL query in this PreparedStatement object and returns the resultset...">executeQuery</a>($sql, $fetchmode);
<a name="l00165"></a>00165             <span class="keywordflow">if</span> ($this-&gt;resultSet-&gt;getRecordCount() === 0) {
<a name="l00166"></a>00166                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00167"></a>00167             }
<a name="l00168"></a>00168             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00169"></a>00169         }
<a name="l00170"></a>00170     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="51f3ba56be7287f0d661d454a06002ed"></a><!-- doxytag: member="StatementCommon::executeQuery" ref="51f3ba56be7287f0d661d454a06002ed" args="($sql, $fetchmode=null)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatementCommon::executeQuery           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>sql</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>fetchmode</em> = <code>null</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Executes the SQL query in this <a class="el" href="interfacePreparedStatement.html">PreparedStatement</a> object and returns the resultset generated by the query. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>string</em>&nbsp;</td><td>$sql This method may optionally be called with the SQL statement. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>int</em>&nbsp;</td><td>$fetchmode The mode to use when fetching the results (e.g. <a class="el" href="interfaceResultSet.html#b846ddf4733df35b24effd71550859b6" title="Index result set numerically.">ResultSet::FETCHMODE_NUM</a>, <a class="el" href="interfaceResultSet.html#7bc05f4b13bf8c1e9b6a4ec32d84a175" title="Index result set by field name.">ResultSet::FETCHMODE_ASSOC</a>). </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>object Creole::ResultSet </dd></dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="classSQLException.html">SQLException</a></em>&nbsp;</td><td>If there is an error executing the specified query. </td></tr>
  </table>
</dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>-cStatementCommon Put native query execution logic in statement subclasses. </dd></dl>

<p>Reimplemented in <a class="el" href="classMSSQLStatement.html#400d33d6b3bc485633b7df755ca95255">MSSQLStatement</a>, and <a class="el" href="classODBCStatement.html#cd8593c504b7c45ef2fdeeb5df9bf1e8">ODBCStatement</a>.</p>

<p>Definition at line <a class="el" href="StatementCommon_8php-source.html#l00236">236</a> of file <a class="el" href="StatementCommon_8php-source.html">StatementCommon.php</a>.</p>

<p>Referenced by <a class="el" href="StatementCommon_8php-source.html#l00157">execute()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00237"></a>00237     {
<a name="l00238"></a>00238         $this-&gt;updateCount = null;
<a name="l00239"></a>00239         <span class="keywordflow">if</span> ($this-&gt;limit &gt; 0 || $this-&gt;offset &gt; 0) {
<a name="l00240"></a>00240             $this-&gt;conn-&gt;applyLimit($sql, $this-&gt;offset, $this-&gt;limit);
<a name="l00241"></a>00241         }
<a name="l00242"></a>00242         $this-&gt;resultSet = $this-&gt;conn-&gt;executeQuery($sql, $fetchmode);
<a name="l00243"></a>00243         <span class="keywordflow">return</span> $this-&gt;resultSet;
<a name="l00244"></a>00244     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="5f7b5b4548ce5e9d9857f67c39449c7e"></a><!-- doxytag: member="StatementCommon::executeUpdate" ref="5f7b5b4548ce5e9d9857f67c39449c7e" args="($sql)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatementCommon::executeUpdate           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>sql</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Executes the SQL INSERT, UPDATE, or DELETE statement in this <a class="el" href="interfacePreparedStatement.html">PreparedStatement</a> object. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>string</em>&nbsp;</td><td>$sql This method may optionally be called with the SQL statement. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>int Number of affected rows (or 0 for drivers that return nothing). </dd></dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="classSQLException.html">SQLException</a></em>&nbsp;</td><td>if a database access error occurs. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="StatementCommon_8php-source.html#l00253">253</a> of file <a class="el" href="StatementCommon_8php-source.html">StatementCommon.php</a>.</p>

<p>Referenced by <a class="el" href="StatementCommon_8php-source.html#l00157">execute()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00254"></a>00254     {
<a name="l00255"></a>00255         <span class="keywordflow">if</span> ($this-&gt;resultSet) $this-&gt;resultSet-&gt;close();
<a name="l00256"></a>00256         $this-&gt;resultSet = null;
<a name="l00257"></a>00257         $this-&gt;updateCount = $this-&gt;conn-&gt;executeUpdate($sql);
<a name="l00258"></a>00258         <span class="keywordflow">return</span> $this-&gt;updateCount;
<a name="l00259"></a>00259     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="05eb018941b9b225b94e96daf87fd6b1"></a><!-- doxytag: member="StatementCommon::getConnection" ref="05eb018941b9b225b94e96daf87fd6b1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatementCommon::getConnection           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets the db <a class="el" href="interfaceConnection.html">Connection</a> that created this statement. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><a class="el" href="interfaceConnection.html">Connection</a> </dd></dl>

<p>Definition at line <a class="el" href="StatementCommon_8php-source.html#l00285">285</a> of file <a class="el" href="StatementCommon_8php-source.html">StatementCommon.php</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00286"></a>00286     {
<a name="l00287"></a>00287         <span class="keywordflow">return</span> $this-&gt;conn;
<a name="l00288"></a>00288     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="259d20b0662d8716e6832342796ebe0c"></a><!-- doxytag: member="StatementCommon::getLimit" ref="259d20b0662d8716e6832342796ebe0c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatementCommon::getLimit           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the maximum number of rows to return or 0 for all. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>int </dd></dl>

<p>Definition at line <a class="el" href="StatementCommon_8php-source.html#l00106">106</a> of file <a class="el" href="StatementCommon_8php-source.html">StatementCommon.php</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00107"></a>00107     {
<a name="l00108"></a>00108         <span class="keywordflow">return</span> $this-&gt;limit;
<a name="l00109"></a>00109     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="3ba2cef34ce4932365531269e391f7f7"></a><!-- doxytag: member="StatementCommon::getMoreResults" ref="3ba2cef34ce4932365531269e391f7f7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatementCommon::getMoreResults           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets next result set (if this behavior is supported by driver). 
<p>
Some drivers (e.g. MSSQL) support returning multiple result sets -- e.g. from stored procedures.<p>
This function also closes any current restult set.<p>
Default behavior is for this function to return false. Driver-specific implementations of this class can override this method if they actually support multiple result sets.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>boolean True if there is another result set, otherwise false. </dd></dl>

<p>Reimplemented in <a class="el" href="classMSSQLStatement.html#6d47284f6a13b66cb334ac076bbf2c1e">MSSQLStatement</a>.</p>

<p>Definition at line <a class="el" href="StatementCommon_8php-source.html#l00274">274</a> of file <a class="el" href="StatementCommon_8php-source.html">StatementCommon.php</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00275"></a>00275     {
<a name="l00276"></a>00276         <span class="keywordflow">if</span> ($this-&gt;resultSet) $this-&gt;resultSet-&gt;close();        
<a name="l00277"></a>00277         $this-&gt;resultSet = null;
<a name="l00278"></a>00278         <span class="keywordflow">return</span> <span class="keyword">false</span>;        
<a name="l00279"></a>00279     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="62bca439d130552f3626026997058f39"></a><!-- doxytag: member="StatementCommon::getOffset" ref="62bca439d130552f3626026997058f39" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatementCommon::getOffset           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the start row. 
<p>
Offset only applies when Limit is set! <dl class="return" compact><dt><b>Returns:</b></dt><dd>int </dd></dl>

<p>Definition at line <a class="el" href="StatementCommon_8php-source.html#l00129">129</a> of file <a class="el" href="StatementCommon_8php-source.html">StatementCommon.php</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00130"></a>00130     {
<a name="l00131"></a>00131         <span class="keywordflow">return</span> $this-&gt;offset;
<a name="l00132"></a>00132     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="993753d50abc8179aa8979be00b1f81e"></a><!-- doxytag: member="StatementCommon::getResultSet" ref="993753d50abc8179aa8979be00b1f81e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatementCommon::getResultSet           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get result set. 
<p>
This assumes that the last thing done was an <a class="el" href="classStatementCommon.html#51f3ba56be7287f0d661d454a06002ed" title="Executes the SQL query in this PreparedStatement object and returns the resultset...">executeQuery()</a> or an <a class="el" href="classStatementCommon.html#576559133fb873a6af1d09f98a880572" title="Generic execute() function has to check to see whether SQL is an update or select...">execute()</a> with SELECT-type query.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>RestultSet (or null if none) </dd></dl>

<p>Definition at line <a class="el" href="StatementCommon_8php-source.html#l00179">179</a> of file <a class="el" href="StatementCommon_8php-source.html">StatementCommon.php</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00180"></a>00180     {
<a name="l00181"></a>00181         <span class="keywordflow">return</span> $this-&gt;resultSet;
<a name="l00182"></a>00182     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="7983c9e7814b9ad944b5f3f6be5c3676"></a><!-- doxytag: member="StatementCommon::getUpdateCount" ref="7983c9e7814b9ad944b5f3f6be5c3676" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatementCommon::getUpdateCount           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get update count. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>int Number of records affected, or <code>null</code> if not applicable. </dd></dl>

<p>Definition at line <a class="el" href="StatementCommon_8php-source.html#l00189">189</a> of file <a class="el" href="StatementCommon_8php-source.html">StatementCommon.php</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00190"></a>00190     {
<a name="l00191"></a>00191         <span class="keywordflow">return</span> $this-&gt;updateCount;
<a name="l00192"></a>00192     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="cffbc17df353ff0597acf8b94d9b73e1"></a><!-- doxytag: member="StatementCommon::isSelect" ref="cffbc17df353ff0597acf8b94d9b73e1" args="($sql)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatementCommon::isSelect           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>sql</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns whether the passed SQL is a SELECT statement. 
<p>
Returns true if SQL starts with 'SELECT' but not 'SELECT INTO'. This exists to support the <a class="el" href="classStatementCommon.html#576559133fb873a6af1d09f98a880572" title="Generic execute() function has to check to see whether SQL is an update or select...">execute()</a> function -- which could either execute an update or a query.<p>
Currently this function does not take into consideration comments, primarily because there are a number of different comment options for different drivers: <pre>
     -- SQL-defined comment, but not truly comment in Oracle
  # comment in mysql
  /* comment in mssql, others * /
  // comment sometimes?
  REM also comment ...
 </pre><p>
If you're wondering why we can't just execute the query and look at the return results to see whether it was an update or a select, the reason is that for update queries we need to do stuff before we execute them -- like start transactions if auto-commit is off.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>string</em>&nbsp;</td><td>$sql </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>boolean Whether statement is a SELECT SQL statement. </dd></dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="classStatementCommon.html#576559133fb873a6af1d09f98a880572" title="Generic execute() function has to check to see whether SQL is an update or select...">execute()</a> </dd></dl>

<p>Definition at line <a class="el" href="StatementCommon_8php-source.html#l00219">219</a> of file <a class="el" href="StatementCommon_8php-source.html">StatementCommon.php</a>.</p>

<p>Referenced by <a class="el" href="StatementCommon_8php-source.html#l00157">execute()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00220"></a>00220     {
<a name="l00221"></a>00221         <span class="comment">// is first word is SELECT, then return true, unless it's SELECT INTO ...</span>
<a name="l00222"></a>00222         <span class="comment">// this doesn't, however, take comments into account ...</span>
<a name="l00223"></a>00223         $sql = trim($sql);
<a name="l00224"></a>00224         <span class="keywordflow">return</span> (stripos($sql, <span class="stringliteral">'select'</span>) === 0 &amp;&amp; stripos($sql, <span class="stringliteral">'select into '</span>) !== 0);
<a name="l00225"></a>00225     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="9d5e121f8fa145559a54d887e74fe206"></a><!-- doxytag: member="StatementCommon::setLimit" ref="9d5e121f8fa145559a54d887e74fe206" args="($v)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatementCommon::setLimit           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>v</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sets the maximum number of rows to return from db. 
<p>
This will affect the SQL if the RDBMS supports native LIMIT; if not, it will be emulated. Limit only applies to queries (not update sql). <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>int</em>&nbsp;</td><td>$v Maximum number of rows or 0 for all rows. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>void </dd></dl>

<p>Definition at line <a class="el" href="StatementCommon_8php-source.html#l00097">97</a> of file <a class="el" href="StatementCommon_8php-source.html">StatementCommon.php</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00098"></a>00098     {
<a name="l00099"></a>00099         $this-&gt;limit = (int) $v;
<a name="l00100"></a>00100     }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="542238485483a30eb0d813a1cb660f6a"></a><!-- doxytag: member="StatementCommon::setOffset" ref="542238485483a30eb0d813a1cb660f6a" args="($v)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatementCommon::setOffset           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>v</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sets the start row. 
<p>
This will affect the SQL if the RDBMS supports native OFFSET; if not, it will be emulated. Offset only applies to queries (not update) and only is evaluated when LIMIT is set! <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>int</em>&nbsp;</td><td>$v </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>void </dd></dl>

<p>Definition at line <a class="el" href="StatementCommon_8php-source.html#l00119">119</a> of file <a class="el" href="StatementCommon_8php-source.html">StatementCommon.php</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00120"></a>00120     {
<a name="l00121"></a>00121         $this-&gt;offset = (int) $v;
<a name="l00122"></a>00122     }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="2d5fcdafcd71692c067e85927b7d487e"></a><!-- doxytag: member="StatementCommon::$conn" ref="2d5fcdafcd71692c067e85927b7d487e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatementCommon::$conn<code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="StatementCommon_8php-source.html#l00035">35</a> of file <a class="el" href="StatementCommon_8php-source.html">StatementCommon.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="948b0c678d3febac37a82b3fb7e2e580"></a><!-- doxytag: member="StatementCommon::$limit" ref="948b0c678d3febac37a82b3fb7e2e580" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatementCommon::$limit = 0<code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="StatementCommon_8php-source.html#l00071">71</a> of file <a class="el" href="StatementCommon_8php-source.html">StatementCommon.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="6eeb510827d12741a7c08d3a8ec4ef1d"></a><!-- doxytag: member="StatementCommon::$offset" ref="6eeb510827d12741a7c08d3a8ec4ef1d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatementCommon::$offset = 0<code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="StatementCommon_8php-source.html#l00078">78</a> of file <a class="el" href="StatementCommon_8php-source.html">StatementCommon.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="170505d7f5e5ff4e63b2adff761dac69"></a><!-- doxytag: member="StatementCommon::$resultClass" ref="170505d7f5e5ff4e63b2adff761dac69" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatementCommon::$resultClass<code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="StatementCommon_8php-source.html#l00059">59</a> of file <a class="el" href="StatementCommon_8php-source.html">StatementCommon.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="0979c915b4dda3f79dab97151eb288b9"></a><!-- doxytag: member="StatementCommon::$resultSet" ref="0979c915b4dda3f79dab97151eb288b9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatementCommon::$resultSet<code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="StatementCommon_8php-source.html#l00041">41</a> of file <a class="el" href="StatementCommon_8php-source.html">StatementCommon.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="e7aa0273a038f439166a7eed9c1b2ab7"></a><!-- doxytag: member="StatementCommon::$stmt" ref="e7aa0273a038f439166a7eed9c1b2ab7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatementCommon::$stmt<code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="StatementCommon_8php-source.html#l00065">65</a> of file <a class="el" href="StatementCommon_8php-source.html">StatementCommon.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="8068d03dd5e27dd01be9f0de4953decf"></a><!-- doxytag: member="StatementCommon::$updateCount" ref="8068d03dd5e27dd01be9f0de4953decf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatementCommon::$updateCount<code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="StatementCommon_8php-source.html#l00047">47</a> of file <a class="el" href="StatementCommon_8php-source.html">StatementCommon.php</a>.</p>

</div>
</div><p>
<a class="anchor" name="c52333efec7eb627970271498b55dd17"></a><!-- doxytag: member="StatementCommon::$warnings" ref="c52333efec7eb627970271498b55dd17" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatementCommon::$warnings = array()<code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="StatementCommon_8php-source.html#l00053">53</a> of file <a class="el" href="StatementCommon_8php-source.html">StatementCommon.php</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li>Static/PhpInclude/FareOfficeLib/3dPart/creole/common/<a class="el" href="StatementCommon_8php-source.html">StatementCommon.php</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed May 6 23:10:50 2009 for fareofficelib by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
